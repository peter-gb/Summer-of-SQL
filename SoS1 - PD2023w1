WITH transactions AS (
    SELECT 
        *
        ,SPLIT_PART(transaction_code,'-',1) AS Bank
        ,CASE online_or_in_person
            WHEN 1 THEN 'Online'
            WHEN 2 THEN 'In-Person'
        END as "Online or In-Person"
        ,DATE(TRANSACTION_DATE, 'DD/MM/YYYY 00:00:00') as Date
        ,DAYNAME(DATE(TRANSACTION_DATE, 'DD/MM/YYYY 00:00:00')) 
        as "Transaction Date"
    FROM PD2023_WK01
)

/* Output 1
SELECT 
    Bank, SUM(value) AS Value
FROM transactions
GROUP BY Bank
*/

/* Output 2
SELECT 
    Bank, "Transaction Date", "Online or In-Person", SUM(value) AS Value
FROM transactions
GROUP BY Bank, "Transaction Date", "Online or In-Person"
*/

SELECT 
    Bank, customer_code, SUM(value) AS Value
FROM transactions
GROUP BY Bank, customer_code


;
